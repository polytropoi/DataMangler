var transloadit = require('./');

// Parameters
var AUTH_KEY = '230a87aec0e44591a5d22cd943430338';
var AUTH_SECRET = 'acde91cf821bc7c1e3a40f25dc76921e4f7d47c9';
var params = 
    {
        steps: {
            import_mp3: {
                robot: "/http/import",
                url: "http://dl.dropbox.com/u/3410758/example.mp3"
            },
            import_pic: {
                robot: "/http/import",
                url: "http://dl.dropbox.com/u/3410758/pz-icon.png"
            },
            mp3_encode: {
                use: ["import_mp3"],
                robot: "/audio/encode",
                preset: "mp3",
                sample_rate: 44100,
                bitrate: 128000
            },
            jpg_encode: {
                use: "import_pic",
                robot: "/image/resize",
                format: "jpg",
                width: 100,
                height: 100,
                resize_strategy: "crop"
            },
            s3_export:{
                use: ["mp3_encode", "jpg_encode"],
                robot: "/s3/store",
                bucket: "glifd",
                key: "1RDD7RN512WAPN6C5MG2",
                secret: "3V6JaSOxyuNRDVpuFoEAldegNoZvAYujj1ZNWTw+"
            }
        },
        notify_url: "http://glifd.com/files_ready"
    };

var client = new transloadit(AUTH_KEY, AUTH_SECRET);
client.send(params, function(ok) {
    console.log('Success: ' + JSON.stringify(ok));
}, function(err) {
    console.log('Error: ' + JSON.stringify(err));
});